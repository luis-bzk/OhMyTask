import{getProjectUrl}from"./functions.js";const showAlert=(e,t,a)=>{const o=document.querySelector(".alert");o&&o.remove();const s=document.createElement("DIV");s.classList.add("alert",t),"error"===t?s.innerHTML=e+' <i class="fa-solid fa-triangle-exclamation"></i>\n      ':s.textContent=e,a.parentElement.insertBefore(s,a.nextElementSibling),setTimeout(()=>{s.remove()},5e3)},addNewTask=async function(e){const t=document.querySelector(".form-task legend"),a=new FormData;a.append("name",e),a.append("project_id",getProjectUrl());try{const e="http://localhost:3000/api/task",o=await fetch(e,{method:"POST",body:a}),s=await o.json();if(showAlert(s.message,s.type,t),"succes"===s.type){const e=document.querySelector(".modal"),t=document.querySelector(".form-task");setTimeout(()=>{t.classList.add("close"),setTimeout(()=>{e.remove()},500)},3e3)}}catch(e){console.log(e)}},submitNewTaskForm=()=>{const e=document.querySelector("#taskName").value.trim(),t=document.querySelector(".form-task legend");e?e.length>60?showAlert("The task name cannot be greater that 60 characters","error",t):addNewTask(e):showAlert("You need to set a Task Name","error",t)};export const showTaskForm=()=>{const e=document.createElement("DIV");e.classList.add("modal"),e.innerHTML='\n    <form class="form-task container-md">\n      <legend>Add new task</legend>\n\n      <div class="field">\n        <label for="taskName">Task Name</label>\n        <input type="text" id="taskName" name="taskName" value="" />\n      </div>\n\n      <div class="field form-task__buttons">\n        <input type="submit" class="button-new-task" value="Add task" />\n        <button type="button" class="close-modal">\n          Cancel\n        </button>\n      </div>\n    </form>\n    ',setTimeout(()=>{document.querySelector(".form-task").classList.add("animation")},100),e.addEventListener("click",(function(t){if(t.preventDefault(),t.target.classList.contains("close-modal")){document.querySelector(".form-task").classList.add("close"),setTimeout(()=>{e.remove()},500)}t.target.classList.contains("button-new-task")&&submitNewTaskForm()})),document.querySelector(".dashboard").appendChild(e)};